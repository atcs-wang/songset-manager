<%# Must pass in: { bandlist: [{band_id, band_nickname}]} %>
<% var viewDirRoot = '../'; %>

<!DOCTYPE html>
<html lang="en">

<head>
    <%- include(viewDirRoot + 'partials/stdhead', {title: "Your Bands"}) %>
</head>

<body>

    <%- include(viewDirRoot + 'partials/navbar') %>

        <!-- Actual page content! -->
        <div class="container">
            <h2>Your Bands:</h2>

            <div class="section" id="controls">
            </div>

            <div class="section" id="bandlist">
                <table class="sortable">
                    <thead>
                        <tr>
                            <th>Band</th>
                            <th>Created On</th>
                            <th>Your Role</th>
                            <th class="no-sort"></th>
                        </tr>

                    </thead>
                    <tbody>
                        <% for (const band of bandlist) { %>
                            <tr>
                                <td> <a href="/band/<%= band.band_id %>/">
                                        <%= band.name %>
                                    </a></td>
                                <td>
                                    <%= band.created_at %>
                                </td>
                                <td>
                                    <%= band.role%>
                                </td>
                                <td>
                                    <% if (band.role=='owner' ) { %>
                                        <form class="confirm-submit right" method="post" display="inline"
                                            action="./<%=band.band_id%>/"
                                            data-confirm-msg='Confirm that you want to delete this band by retyping "<%=band.name%>":'
                                            data-require-retype="<%=band.name%>">

                                            <input type="hidden" name="method" value="delete">

                                            <button class="btn-small waves-effect waves-light red" type="submit">
                                                <i class="material-icons right">delete</i>
                                                Delete Band
                                            </button>
                                        </form>
                                    <% } %>

                                </td>
                            </tr>
                            <% } %>
                    </tbody>
                </table>
            </div>
            <div class="fixed-action-btn">
                <a class="btn-floating btn-large waves-effect waves-light red modal-trigger" href="#createband"><i class="material-icons">add</i></a>
            </div>
            <div id="createband" class="modal">
                <div class="modal-content">
                    <h2>Create a new Band</h2>
                    
                    <form id="createBandForm" method="post">
                        <input type="hidden" name="method" value="create">

                        <div class="input-field">
                            <input type="text" id="nameInput" name="name" class="validate" data-length="40"
                                maxlength="40">
                            <label for="nameInput">Band Name:</label>
                        </div>

                        <p> You will be the "creator" and first "member" of this band, with the role of "owner". You can add more members with various roles afterwards.</p>
                        <div class="input-field">
                            <input type="text" id="nicknameInput" name="nickname" class="validate" data-length="40"
                                maxlength="40">
                            <label for="nicknameInput">Your nickname in this band:</label>
                        </div>
                    </form>

                </div>

                <div class="modal-footer">

                    <button class="btn waves-effect waves-light " type="submit" form="createBandForm">
                        <i class="material-icons right">send</i>
                        Create Band
                    </button>
                    <a href="#!" class="modal-close waves-effect waves-green btn-flat">Close</a>
                </div>
            </div>

        </div>

        </div>

        <%- include(viewDirRoot + 'partials/stdfoot') %>

</body>

</html>